<template name="permissionsTable">
	<table border="1" class="permission-grid secondary-background-color">
		<thead class="content-background-color">
		<tr>
			<th class="border-component-color">&nbsp;</th>
			{{#each role in allRoles}}
				<th class="border-component-color" title="{{role.description}}">
					<a href="{{pathFor "admin-permissions-edit" name=role._id}}">
						{{role._id}}
						<i class="icon-edit"></i>
					</a>
				</th>
			{{/each}}
		</tr>
		</thead>
		<tbody>
		{{#each permission in permissions}}
			<tr class="admin-table-row">
				<td class="permission-name border-component-color" title="{{permissionDescription permission}}">{{permissionName permission}}<br>[{{permission._id}}]
				</td>
				{{#each role in allRoles}}
					<td class="border-component-color">
						<input type="checkbox" name="perm[{{_id}}][{{../_id}}]" class="role-permission"
							   value="1" checked="{{granted permission.roles role}}" data-role="{{role._id}}"
							   data-permission="{{permission._id}}">
					</td>
				{{/each}}
			</tr>
		{{/each}}
		</tbody>
	</table>
</template>
<template name="permissions">
	<div class="permissions-manager">
		{{#if hasPermission}}
			<a href="{{pathFor "admin-permissions-new"}}" class="button primary new-role">{{_ "New_role"}}</a>
			{{> permissionsTable permissions=permissions allRoles=roles}}
			{{#if settingPermissionExpanded}}
				<div class="js-toggle-setting-permissions">{{_ "setting-permissions-collapse"}}</div>
				{{> permissionsTable permissions=settingPermissions allRoles=roles}}
			{{else}}
				<div class="js-toggle-setting-permissions">{{_ "setting-permissions-expand"}}</div>
			{{/if}}
		{{else}}
			{{_ "Not_authorized"}}
		{{/if}}
	</div>
</template>
